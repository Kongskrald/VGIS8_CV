\chapter{Assembly}
\input{chapters/robot_control.tex}

\section{Final Assembly}
%When actually performing it in practice this is how we did it. First the hand eye calibration was run. The points chosen for calibration were the bolts that were in the workspace because they were constant points. The robot tool was then placed horizontal to the workspace using the teach pendant so the bolt was in the centre of the gripper. The tool's x and y positions were then saved for calibration. Since these positions would not change as the workspace was where the robot was mounted it was not necessary to get more than once. The the same pixel values of the same location was found and the calibration was done.  
%
%After the calibration a brown flat cardboard was put onto the workspace to minimize the reflection from the metallic surface. Then an image of the workspace is taken without the bricks and with the bricks for background subtraction. Then the image processing is done resulting in brick centres, colours and rotations. The robot can now be ordered to assemble a figure e.g. Homer by taking the first appropriate bricks from the top of the image. It moves to the centre of the brick's position an rotates the corresponding degrees around the Z axis to be able to grab the brick.  The figure is then delivered to the drop off zone and prepares for a new order. 
%

The assembly is made on the platform where the Universal Robot (UR5) is mounted. Here a piece of cardboard is laid out on the platform to occlude the shiny metal background, easing the image processing as this will give a plain background to process instead of a reflective surface.

For each initialisation of the program a new picture is taken of the background, then bricks are placed in the workspace and a picture is taken. The positions and orientation of the bricks are found using the image processing described in \autoref{ch:img_proc}.

When the image processing is done it is possible to order any of the five Simpsons characters from the MATLAB command window. Because of functionality issues with the gripper on the robot it was not possible to physically assemble the figurines. Instead the robot marks the two or three bricks used for the specific character, taking the theoretically height into account as well and moves to the drop-off point. A red brick was used as the middle piece in the Homer character as there was not any white bricks available. The amount of bricks was limited to the option of building one of each character. Had there not been any issues with the gripper the characters could have been assembled and placed in the drop-off area, as proved in the example video.

