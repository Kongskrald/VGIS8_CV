%!TEX root = ../../master.tex
\subsection{Reverb}
\label{subs:reverb_analysis}

Reverb is one of the longer effects, which is also shown in \autoref{tab:delay_times}. 

Natural reverberation is sound being reflected off of surfaces in closed spaces and is a combination of early and late reflections from the surroundings. The amount of reverberation depends on the room size, angle of the walls and room content and the density of the surface, as different structures has many different properties regarding sound. An illustration of the reflections is shown in \autoref{fig:reverb_ill}.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.8\textwidth]{reverberation_room}
	\caption{Illustration of reverberation in a closed room.}
	\label{fig:reverb_ill}
\end{figure}

To make this effect, the reflections of a room need to be mimicked digitally. Reverb is time-invariant which means that it does not matter when you play the note compared to effects like flanger which is time-variant. This means that the reverb effect can be characterized completely by the impulse response. The effect is created by multiple delays and feedbacks which makes a dense series of echoes that die out over time. By variation and how these are stacked creates the characteristic sound of reverberation. 

The reverb effect can be created with an all-pass filter, comb filters and a delay line as shown on  \autoref{fig:moorer_reverb}. Different parts of the system contributes to different parts of the effect. 
The tapped delay line gives the early reflections of the reverb. The delay line is the upper part of \autoref{fig:moorer_reverb}. This simulates the first reflections from the walls and the direct signal from the audio source to the listener by making clean delays of the input signal. 

The late reflections are handled by comb filters which are seen at the lower left of \autoref{fig:moorer_reverb}. The comb filters are named $C_n$. These gives the reflections of the reflected signals. Since the signal travels to the separate walls in roughly the same time the comb filters gives a rapidly dying repetition of the reflected signal. Moorer's reverb works best with six first order comb filters in parallel. The \gls{iir} comb filter is shown on \autoref{fig:comb_iir}.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.8\textwidth]{figures/design/IIR_comb.pdf}
	\caption{IIR comb filter.}
	\label{fig:comb_iir}
\end{figure}

The all-pass gives the sound a muddy feel by repeating the reflected signal rapidly. This is the block $A_1$ seen on \autoref{fig:moorer_reverb} in the lower right corner. The all-pass filter in a moore's reverb is recommended to have a delay length of \SI{6}{\milli\second} and with a gain of 0.7.

The output of the all-pass filter are delayed in order to move the late reflections behind the early reflections. 

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.8\textwidth]{moorers_reverb.pdf}
	\caption{Moorerâ€™s reverberator \citep{DAFX}.}
	\label{fig:moorer_reverb}
\end{figure}
\newpage